<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EZ_PARALLEL: jacobian_ekman_shear_solve Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EZ_PARALLEL
   &#160;<span id="projectnumber">ALPHA 1.01</span>
   </div>
   <div id="projectbrief">A Fortran module to ease the process of parallelizing somewhat simple finite difference codes.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">jacobian_ekman_shear_solve Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module containing the solver for the Jacobian, Ekman friction, and vertical shear terms subroutine needed for the example parallel two-level QG equation code.  
<a href="namespacejacobian__ekman__shear__solve.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a31d0979d5f911a1f397b1f1b3dd392ad"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#a31d0979d5f911a1f397b1f1b3dd392ad">jacobian_ekman_shear</a> (freqPotVortGrid, xLenSub, yLenSub, deformWavenumSub, rotatWavenumSub, vertShearSub, ekmanFricCoeffSub, jacobianEkmanShearGrid)</td></tr>
<tr class="memdesc:a31d0979d5f911a1f397b1f1b3dd392ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the Jacobian term, the Ekman friction term, and the vertical shear term in the QG equation for use in progressing the simulation forward in time.  <a href="namespacejacobian__ekman__shear__solve.html#a31d0979d5f911a1f397b1f1b3dd392ad">More...</a><br /></td></tr>
<tr class="separator:a31d0979d5f911a1f397b1f1b3dd392ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba3f339129fc80eb3c2a74d71df099d9"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#aba3f339129fc80eb3c2a74d71df099d9">spectral_x_derivative</a> (xLenSub, yLenSub, specXDeriv, order)</td></tr>
<tr class="memdesc:aba3f339129fc80eb3c2a74d71df099d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the wavenumber array needed to take the derivative in the x-direction in frequency space.  <a href="namespacejacobian__ekman__shear__solve.html#aba3f339129fc80eb3c2a74d71df099d9">More...</a><br /></td></tr>
<tr class="separator:aba3f339129fc80eb3c2a74d71df099d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add32ba3dedd13ba38db46cc672a8c052"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#add32ba3dedd13ba38db46cc672a8c052">spectral_y_derivative</a> (xLenSub, yLenSub, specYDeriv, order)</td></tr>
<tr class="memdesc:add32ba3dedd13ba38db46cc672a8c052"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the wavenumber array needed to take the derivative in the y-direction in frequency space.  <a href="namespacejacobian__ekman__shear__solve.html#add32ba3dedd13ba38db46cc672a8c052">More...</a><br /></td></tr>
<tr class="separator:add32ba3dedd13ba38db46cc672a8c052"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aeb6c3bc95ad3cfb27ce5432762b944"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#a3aeb6c3bc95ad3cfb27ce5432762b944">zero_padding</a> (dim1Len, dim2Len, matrix, sclDim1Len, sclDim2Len, scaledMatrix)</td></tr>
<tr class="memdesc:a3aeb6c3bc95ad3cfb27ce5432762b944"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zero-pads array going by 3/2s-rule.  <a href="namespacejacobian__ekman__shear__solve.html#a3aeb6c3bc95ad3cfb27ce5432762b944">More...</a><br /></td></tr>
<tr class="separator:a3aeb6c3bc95ad3cfb27ce5432762b944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26a87cdeeb2f73dd49a5b91ec434aca9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#a26a87cdeeb2f73dd49a5b91ec434aca9">zero_padding_inv</a> (dim1Len, dim2Len, matrix, sclDim1Len, sclDim2Len, scaledMatrix)</td></tr>
<tr class="memdesc:a26a87cdeeb2f73dd49a5b91ec434aca9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Un-zero-pads array going by 3/2s-rule.  <a href="namespacejacobian__ekman__shear__solve.html#a26a87cdeeb2f73dd49a5b91ec434aca9">More...</a><br /></td></tr>
<tr class="separator:a26a87cdeeb2f73dd49a5b91ec434aca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab6fb8e5e008c599a4e09db0561093f98"><td class="memItemLeft" align="right" valign="top">complex(dp), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#ab6fb8e5e008c599a4e09db0561093f98">speclaplacian</a></td></tr>
<tr class="memdesc:ab6fb8e5e008c599a4e09db0561093f98"><td class="mdescLeft">&#160;</td><td class="mdescRight">The discrete Laplacian operator in spectral space.  <a href="namespacejacobian__ekman__shear__solve.html#ab6fb8e5e008c599a4e09db0561093f98">More...</a><br /></td></tr>
<tr class="separator:ab6fb8e5e008c599a4e09db0561093f98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa15c8658b43c0cf141d131daaf53cb0d"><td class="memItemLeft" align="right" valign="top">complex(dp), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#aa15c8658b43c0cf141d131daaf53cb0d">specinvbarotropic</a></td></tr>
<tr class="memdesc:aa15c8658b43c0cf141d131daaf53cb0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The discrete inverse barotropic operator in spectral space (see two-layer QG equations in Di, Q., &amp; Majda, A. (2015)).  <a href="namespacejacobian__ekman__shear__solve.html#aa15c8658b43c0cf141d131daaf53cb0d">More...</a><br /></td></tr>
<tr class="separator:aa15c8658b43c0cf141d131daaf53cb0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a922d20a00080481515d1de3192f29c4e"><td class="memItemLeft" align="right" valign="top">complex(dp), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#a922d20a00080481515d1de3192f29c4e">specinvbaroclinic</a></td></tr>
<tr class="memdesc:a922d20a00080481515d1de3192f29c4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The discrete inverse baroclinic operator in spectral space (see two-layer QG equations in Di, Q., &amp; Majda, A. (2015)).  <a href="namespacejacobian__ekman__shear__solve.html#a922d20a00080481515d1de3192f29c4e">More...</a><br /></td></tr>
<tr class="separator:a922d20a00080481515d1de3192f29c4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65f2a43b261530c191354aa185d11700"><td class="memItemLeft" align="right" valign="top">complex(dp), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#a65f2a43b261530c191354aa185d11700">specxderiv</a></td></tr>
<tr class="memdesc:a65f2a43b261530c191354aa185d11700"><td class="mdescLeft">&#160;</td><td class="mdescRight">The wavenumber array for calculating the x-derivative in spectral space.  <a href="namespacejacobian__ekman__shear__solve.html#a65f2a43b261530c191354aa185d11700">More...</a><br /></td></tr>
<tr class="separator:a65f2a43b261530c191354aa185d11700"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e91f0e60343f39558fcfe51f507144c"><td class="memItemLeft" align="right" valign="top">complex(dp), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#a1e91f0e60343f39558fcfe51f507144c">specyderiv</a></td></tr>
<tr class="memdesc:a1e91f0e60343f39558fcfe51f507144c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The wavenumber array for calculating the y-derivative in spectral space.  <a href="namespacejacobian__ekman__shear__solve.html#a1e91f0e60343f39558fcfe51f507144c">More...</a><br /></td></tr>
<tr class="separator:a1e91f0e60343f39558fcfe51f507144c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae89ea2b283b45d82bad423c03e5ac833"><td class="memItemLeft" align="right" valign="top">complex(dp), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#ae89ea2b283b45d82bad423c03e5ac833">scaledspecxderiv</a></td></tr>
<tr class="memdesc:ae89ea2b283b45d82bad423c03e5ac833"><td class="mdescLeft">&#160;</td><td class="mdescRight">The wavenumber array for calculating the x-derivative in spectral space for the zero-padded grid.  <a href="namespacejacobian__ekman__shear__solve.html#ae89ea2b283b45d82bad423c03e5ac833">More...</a><br /></td></tr>
<tr class="separator:ae89ea2b283b45d82bad423c03e5ac833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dcacb616828406ccb505e3e2794038a"><td class="memItemLeft" align="right" valign="top">complex(dp), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#a1dcacb616828406ccb505e3e2794038a">scaledspecyderiv</a></td></tr>
<tr class="memdesc:a1dcacb616828406ccb505e3e2794038a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The wavenumber array for calculating the y-derivative in spectral space for the zero-padded grid.  <a href="namespacejacobian__ekman__shear__solve.html#a1dcacb616828406ccb505e3e2794038a">More...</a><br /></td></tr>
<tr class="separator:a1dcacb616828406ccb505e3e2794038a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd4d55635c82fb4c4f94db63440678d1"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejacobian__ekman__shear__solve.html#acd4d55635c82fb4c4f94db63440678d1">ran</a> = .FALSE.</td></tr>
<tr class="memdesc:acd4d55635c82fb4c4f94db63440678d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the discrete differential spectral operators needed for the solver.  <a href="namespacejacobian__ekman__shear__solve.html#acd4d55635c82fb4c4f94db63440678d1">More...</a><br /></td></tr>
<tr class="separator:acd4d55635c82fb4c4f94db63440678d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module containing the solver for the Jacobian, Ekman friction, and vertical shear terms subroutine needed for the example parallel two-level QG equation code. </p>
<p>Module containing the solver for the Jacobian, Ekman friction, and vertical shear terms subroutine needed for the example serial two-level QG equation code.</p>
<dl class="section author"><dt>Author</dt><dd>Jason Turner </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a31d0979d5f911a1f397b1f1b3dd392ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31d0979d5f911a1f397b1f1b3dd392ad">&#9670;&nbsp;</a></span>jacobian_ekman_shear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine public jacobian_ekman_shear_solve::jacobian_ekman_shear </td>
          <td>(</td>
          <td class="paramtype">complex(dp), dimension(xlensub,ylensub,2), intent(in)&#160;</td>
          <td class="paramname"><em>freqPotVortGrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>xLenSub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>yLenSub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>deformWavenumSub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>rotatWavenumSub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>vertShearSub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>ekmanFricCoeffSub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(dp), dimension(xlensub,ylensub,2), intent(inout)&#160;</td>
          <td class="paramname"><em>jacobianEkmanShearGrid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the Jacobian term, the Ekman friction term, and the vertical shear term in the QG equation for use in progressing the simulation forward in time. </p>
<dl class="section author"><dt>Author</dt><dd>Jason Turner, University of Wisconsin-Madison If the subroutine hasn't been called before, calculate all of the differential operators needed. Calculate the contributions from the mean vertical shear and rotation deformation in levels 1 and 2, and the Ekman friction in layer 2. Rescale the grid to de-alias it and calculate the derivatives in spectral space. Transform into physical space to perform the multiplications to calculate the Jacobian term, and transform back into frequency space to return the final result. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">freqPotVortGrid</td><td>Potential vorticity grid in frequency space. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xLenSub</td><td>Size of the grid along the first dimension, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yLenSub</td><td>Size of the grid along the second dimension, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">deformWavenumSub</td><td>The baroclinic deformation wavenumber corresponding to the Rossby radius of deformation, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotateWavenumSub</td><td>The wavenumber corresponding to the rotation coefficient, which controls the advection of streamfunctions, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vertShearSub</td><td>Large-scale vertical shear, opposite direction in each level to induce baroclinic instability, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ekamnFricCoeffSub</td><td>The coefficient for Ekman friction in level 2, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jacobianEkmanShearGrid</td><td>Contains sum of the Jacobian, Ekman friction, and mean shear terms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xlensub</td><td>ADDED TO PARALLEL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Jason Turner, University of Wisconsin-Madison If the subroutine hasn't been called before, calculate all of the differential operators needed. Calculate the contributions from the mean vertical shear and rotation deformation in levels 1 and 2, and the Ekman friction in layer 2. Rescale the grid to de-alias it and calculate the derivatives in spectral space. Transform into physical space to perform the multiplications to calculate the Jacobian term, and transform back into frequency space to return the final result. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">freqPotVortGrid</td><td>Potential vorticity grid in frequency space. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xLenSub</td><td>Size of the grid along the first dimension, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yLenSub</td><td>Size of the grid along the second dimension, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">deformWavenumSub</td><td>The baroclinic deformation wavenumber corresponding to the Rossby radius of deformation, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotateWavenumSub</td><td>The wavenumber corresponding to the rotation coefficient, which controls the advection of streamfunctions, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vertShearSub</td><td>Large-scale vertical shear, opposite direction in each level to induce baroclinic instability, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ekamnFricCoeffSub</td><td>The coefficient for Ekman friction in level 2, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jacobianEkmanShearGrid</td><td>Contains sum of the Jacobian, Ekman friction, and mean shear terms. </td></tr>
  </table>
  </dd>
</dl>
<p>EDITTED FOR PARALLEL.</p>
<p>EDITTED FOR PARALLEL.</p>
<p>EDITTED FOR PARALLEL.</p>
<p>EDITTED FOR PARALLEL.</p>
<p>EDITTED FOR PARALLEL.</p>
<p>EDITTED FOR PARALLEL.</p>
<p>EDITTED FOR PARALLEL.</p>
<p>EDITTED FOR PARALLEL.</p>
<p>EDITTED FOR PARALLEL.</p>
<p>EDITTED FOR PARALLEL.</p>
<p>EDITTED FOR PARALLEL.</p>
<p>EDITTED FOR PARALLEL.</p>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00094">94</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
<a id="aba3f339129fc80eb3c2a74d71df099d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba3f339129fc80eb3c2a74d71df099d9">&#9670;&nbsp;</a></span>spectral_x_derivative()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine public jacobian_ekman_shear_solve::spectral_x_derivative </td>
          <td>(</td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>xLenSub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>yLenSub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(dp), dimension(xlensub,ylensub), intent(inout)&#160;</td>
          <td class="paramname"><em>specXDeriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the wavenumber array needed to take the derivative in the x-direction in frequency space. </p>
<dl class="section author"><dt>Author</dt><dd>Jason Turner, University of Wisconsin-Madison Calculates the wavenumbers in the x-direction. If xLenSub even and order odd, zero out the xLenSub/2 wavenumber. Populate specXDeriv array with (sqrt(-1)*x wavenumber)**order. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xLenSub</td><td>Size of the grid along the first dimension, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yLenSub</td><td>Size of the grid along the second dimension, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">specXDeriv</td><td>Array to store coefficients needed for numerical derivative in spectral space. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>Order of the derivative needed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00394">394</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
<a id="add32ba3dedd13ba38db46cc672a8c052"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add32ba3dedd13ba38db46cc672a8c052">&#9670;&nbsp;</a></span>spectral_y_derivative()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine public jacobian_ekman_shear_solve::spectral_y_derivative </td>
          <td>(</td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>xLenSub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>yLenSub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(dp), dimension(xlensub,ylensub), intent(inout)&#160;</td>
          <td class="paramname"><em>specYDeriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the wavenumber array needed to take the derivative in the y-direction in frequency space. </p>
<dl class="section author"><dt>Author</dt><dd>Jason Turner, University of Wisconsin-Madison Calculates the wavenumbers in the y-direction. If yLenSub even and order odd, zero out the xLenSub/2 wavenumber. Populate specYDeriv array with (sqrt(-1)*y wavenumber)**order. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xLenSub</td><td>Size of the grid along the first dimension, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yLenSub</td><td>Size of the grid along the second dimension, local to subroutine. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">specYDeriv</td><td>Array to store coefficients needed for numerical derivative in spectral space. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>Order of the derivative needed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00445">445</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
<a id="a3aeb6c3bc95ad3cfb27ce5432762b944"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aeb6c3bc95ad3cfb27ce5432762b944">&#9670;&nbsp;</a></span>zero_padding()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine jacobian_ekman_shear_solve::zero_padding </td>
          <td>(</td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>dim1Len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>dim2Len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(dp), dimension(dim1len,dim2len), intent(in)&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>sclDim1Len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>sclDim2Len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(dp), dimension(scldim1len,scldim2len), intent(inout)&#160;</td>
          <td class="paramname"><em>scaledMatrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Zero-pads array going by 3/2s-rule. </p>
<dl class="section author"><dt>Author</dt><dd>Jason Turner, University of Wisconsin-Madison Calculates the index in the scaled matrix of the largest negative wavenumber in both dim1 and dim2. Fills in the non-zero entries of the scaled matrix (which correspond to the wavenumbers of the original matrix) with the entries of the original matrix. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dim1Len</td><td>Length along first dimension of array to zero-pad. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dim2Len</td><td>Length along second dimension of array to zero-pad. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">matrix</td><td>Array to zero-pad. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sclDim1Len</td><td>Length along first dimension of zero-padded array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sclDim2Len</td><td>Length along second dimension of zero-padded array. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">scaledMatrix</td><td>Zero-padded array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00498">498</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
<a id="a26a87cdeeb2f73dd49a5b91ec434aca9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26a87cdeeb2f73dd49a5b91ec434aca9">&#9670;&nbsp;</a></span>zero_padding_inv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine jacobian_ekman_shear_solve::zero_padding_inv </td>
          <td>(</td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>dim1Len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>dim2Len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(dp), dimension(dim1len,dim2len), intent(inout)&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>sclDim1Len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(qb), intent(in)&#160;</td>
          <td class="paramname"><em>sclDim2Len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(dp), dimension(scldim1len,scldim2len), intent(in)&#160;</td>
          <td class="paramname"><em>scaledMatrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Un-zero-pads array going by 3/2s-rule. </p>
<dl class="section author"><dt>Author</dt><dd>Jason Turner, University of Wisconsin-Madison Calculates the index in the scaled matrix of the largest negative wavenumber in both dim1 and dim2. Fills in the non-zero entries of the scaled matrix (which correspond to the wavenumbers of the original matrix) with the entries of the original matrix. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dim1Len</td><td>Length along first dimension of array to zero-pad. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dim2Len</td><td>Length along second dimension of array to zero-pad. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">matrix</td><td>Array to zero-pad. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sclDim1Len</td><td>Length along first dimension of zero-padded array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sclDim2Len</td><td>Length along second dimension of zero-padded array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scaledMatrix</td><td>Zero-padded array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00565">565</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="acd4d55635c82fb4c4f94db63440678d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd4d55635c82fb4c4f94db63440678d1">&#9670;&nbsp;</a></span>ran</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical jacobian_ekman_shear_solve::ran = .FALSE.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the discrete differential spectral operators needed for the solver. </p>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00049">49</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
<a id="ae89ea2b283b45d82bad423c03e5ac833"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae89ea2b283b45d82bad423c03e5ac833">&#9670;&nbsp;</a></span>scaledspecxderiv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">complex(dp), dimension(:,:,:), allocatable jacobian_ekman_shear_solve::scaledspecxderiv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The wavenumber array for calculating the x-derivative in spectral space for the zero-padded grid. </p>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00043">43</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
<a id="a1dcacb616828406ccb505e3e2794038a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dcacb616828406ccb505e3e2794038a">&#9670;&nbsp;</a></span>scaledspecyderiv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">complex(dp), dimension(:,:,:), allocatable jacobian_ekman_shear_solve::scaledspecyderiv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The wavenumber array for calculating the y-derivative in spectral space for the zero-padded grid. </p>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00046">46</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
<a id="a922d20a00080481515d1de3192f29c4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a922d20a00080481515d1de3192f29c4e">&#9670;&nbsp;</a></span>specinvbaroclinic</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">complex(dp), dimension(:,:), allocatable jacobian_ekman_shear_solve::specinvbaroclinic</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The discrete inverse baroclinic operator in spectral space (see two-layer QG equations in Di, Q., &amp; Majda, A. (2015)). </p>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00036">36</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
<a id="aa15c8658b43c0cf141d131daaf53cb0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa15c8658b43c0cf141d131daaf53cb0d">&#9670;&nbsp;</a></span>specinvbarotropic</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">complex(dp), dimension(:,:), allocatable jacobian_ekman_shear_solve::specinvbarotropic</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The discrete inverse barotropic operator in spectral space (see two-layer QG equations in Di, Q., &amp; Majda, A. (2015)). </p>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00033">33</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
<a id="ab6fb8e5e008c599a4e09db0561093f98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6fb8e5e008c599a4e09db0561093f98">&#9670;&nbsp;</a></span>speclaplacian</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">complex(dp), dimension(:,:), allocatable jacobian_ekman_shear_solve::speclaplacian</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The discrete Laplacian operator in spectral space. </p>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00031">31</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
<a id="a65f2a43b261530c191354aa185d11700"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65f2a43b261530c191354aa185d11700">&#9670;&nbsp;</a></span>specxderiv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">complex(dp), dimension(:,:,:), allocatable jacobian_ekman_shear_solve::specxderiv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The wavenumber array for calculating the x-derivative in spectral space. </p>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00039">39</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
<a id="a1e91f0e60343f39558fcfe51f507144c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e91f0e60343f39558fcfe51f507144c">&#9670;&nbsp;</a></span>specyderiv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">complex(dp), dimension(:,:,:), allocatable jacobian_ekman_shear_solve::specyderiv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The wavenumber array for calculating the y-derivative in spectral space. </p>

<p class="definition">Definition at line <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html#l00041">41</a> of file <a class="el" href="parallel__code_2two__level__qg_2jacobian__ekman__shear__solve_8f90_source.html">jacobian_ekman_shear_solve.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
